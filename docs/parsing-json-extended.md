# Парсинг JSON

[Назад к списку компонентов](../README.md)

## Назначение

Компонент преобразовывает строку или набор строк JSON в табличный набор данных. Использует библиотеку [JMESPath](https://github.com/jmespath/jmespath.js) как внешний модуль.

## Входные порты

| Название                | Тип        |
|:------------------------|:-----------|
| Входной источник данных | Таблица    |
| Настройки               | Переменные |

### Структура таблицы "Входной источник данных"

| Метка         | Тип                                       | Описание                       |
|:--------------|:------------------------------------------|:-------------------------------|
| Строка JSON   | ![](./img/string.svg) Строковый           | Набор данных в формате JSON    |

### Переменные в порте "Настройки"

| № | Метка                                       | Тип                                 | Значение  |
|:--|:--------------------------------------------|:------------------------------------|:----------|
| 1 | Дублировать единичные значения              | ![](./img/logical.svg) Логический   | true      |
| 2 | Дублировать значения родительских узлов     | ![](./img/logical.svg) Логический   | true      |
| 3 | Генерировать составные метки полей          | ![](./img/logical.svg) Логический   | true      |
| 4 | Генерировать поля переменного типа данных   | ![](./img/logical.svg) Логический   | false     |
| 5 | Выражение jmespath                          | ![](./img/string.svg) Строковый     |           |

1. **Дублировать единичные значения** — дублирование родительских узлов и узлов-братьев. Опция имеет приоритет перед опцией **Дублировать значения родительских узлов**.
2. **Дублировать значения родительских узлов** — дублирование значений родительских узлов так же происходит при включении флага **Дублировать единичные значения**. Опция имеет меньший приоритет перед опцией **Дублировать единичные значения**.
3. **Генерировать составные метки полей** — при наличии данного флага в каждой метке поля будет отражена иерархия относительно корневого элемента.
4. **Генерировать поля переменного типа данных** — все поля результирующей таблицы генерируются с типом данных "Переменный".
5. **Выражение jmespath** — текст запроса, применяемый к исходному JSON перед трансформацией в таблицу. В компоненте возможна предварительная модификация исходного json с помощью [запроса к json](https://jmespath.org/tutorial.html). Если в параметре **Path** компонента задан текст запроса, то он будет применен к исходному JSON, и уже результат запроса преобразуется в таблицу. Если запрос не задан (параметр запроса пустой), то в таблицу преобразовывается исходный JSON.

## Выходные порты

| Название                | Тип         |
|:------------------------|:------------|
| Выходной набор данных   | Таблица     |
| Ошибки                  | Переменные  |

### Структура таблицы "Выходной набор данных"

Состав полей в порту формируется динамически (используется автосинхронизация полей) и зависит от структуры JSON. Набор данных содержит обязательное поле **Исключение**, исключение выводится в строке с проблемным элементом JSON.

### Переменные в порте "Переменные"

| № | Метка                   | Тип                               | Значение  |
|:--|:------------------------|:----------------------------------|:----------|
| 1 | Исключение              | ![](./img/string.svg) Строковый   | В переменную выводится текст перехваченной ошибки в ходе трансформации данных      |